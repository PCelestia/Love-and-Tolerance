---
on:
  push:
    tags:
    - "wip-*"

name: prerelease

jobs:
  draft-release:
    name: draft-prerelease
    runs-on: ubuntu-20.04

    steps:
    - name: setup env
      run: echo ::set-env name=RELEASE_VERSION::${GITHUB_REF#refs/*/}

    - name: checkout repository
      uses: actions/checkout@v2

    - name: package resource pack
      uses: montudor/action-zip@v0.1.0
      with:
        args: zip Love-and-Tolerance-${{ env.RELEASE_VERSION }}.zip assets LICENSE pack.mcmeta pack.png

    - name: create draft release
      uses: ncipollo/release-action@v1
      with:
        artifacts: Love-and-Tolerance-${{ env.RELEASE_VERSION }}.zip
        body: |
          [Download prerelease ${{ env.RELEASE_VERSION }} here](https://github.com/Love-and-Tolerance/Love-and-Tolerance/releases/download/${{ env.RELEASE_VERSION }}/Love-and-Tolerance-${{ env.RELEASE_VERSION }}.zip)
          [Download latest release](https://github.com/Love-and-Tolerance/Love-and-Tolerance/releases/latest/download/Love-and-Tolerance.zip)

          TODO add changelog and stuff
          TODO add minecraft version to the name of the release
          TODO remove these todo messages and things lol
        draft: true
        prerelease: true
        name: Love and tolerance ${{ env.RELEASE_VERSION }}
        token: ${{ secrets.GITHUB_TOKEN }}
